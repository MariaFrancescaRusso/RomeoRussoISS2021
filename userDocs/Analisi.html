<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>

<link rel="stylesheet" type="text/css" href="./utils/style.css">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<base href=".">
<title>RomeoRussoStandingBuffetService</title>
</head>

<body>

<div id="top">
<h1>STANDING BUFFET SERVICE | Ingengeria dei Sistemi Software</h1>
</div>

<div class="body">

<h2>Introduction</h2>

Keeping in mind the motto: <bc>"there is no code without a project, no project without problem analysis and no problem without requirements"</bc>, this document presents a possible solution to the requirements provided by the customer, achieved with a top-down approach in three main phase: requirements analysis, problem analysis and a design phase.

<h2 id="req_text">Requirements</h2>

<div class="remark">
Below it's shown the <a href="./utils/tf/TemaFinaleBo19.html" target="_black">requirements text</a> provided by the customer.<br>
<iframe src="./utils/tf/TemaFinaleBo19.html" title="Requirements text"><a href="./utils/tf/TemaFinaleBo19.html" target="_black">Requirements Text Link</a></iframe>
</div>

<h2>Requirement analysis</h2>

<h3>Glossary</h3>

By the interaction with the customer, here it's exposed a essential glossary about the meaning of the names and of the verbs included in the <a href="#req_text">requirements text</a> given by the customer.
<br><br>
<table>
<tr>
	<td class="title"><ks>room</ks></td>
	<td>It's an environment equipped with a set of smart and non-smart resources and in which the interactions between these elements happen. These resources are: a <ks>pantry</ks>, a <ks>dishwasher</ks> and a <ks>fridge</ks>, that are all embedded into the wall of the room; a <ks>table</ks>, that is placed in the center of the room; an <ks>RBR</ks>. When system starts no people is in it, besides the <ks>Maître de Salle</ks>.</td>
</tr>
<tr>
	<td class="title"><ks>Maître de Salle</ks></td>
	<td>Person who manages the <ks>room</ks> and its elements, using the <ks>maître's smartphone</ks>.</td>
</tr>
<tr>
	<td class="title"><ks>maître's smartphone</ks></td>
	<td>Smartphone application or a user-GUI in a browser used by <ks>Maître de Salle</ks> to interact with smart resources in the <ks>room</ks> (<ks>fridge</ks> and <ks>RBR</ks>).</td>
</tr>
<tr>
	<td class="title"><ks>fridge</ks></td>
	<td>It's a smart device, having knowledge base on his storage, and an "Internet Thing". It's embedded into the wall of the <ks>room</ks> and it's filled with a proper set of items when system starts. It must be able to comunicate, via CoAP, with <ks>maître's smartphone</ks> and <ks>RBR</ks>.</td>
</tr>
<tr>
	<td class="title"><ks>pantry</ks></td>
	<td>It's a non-smart resource embedded into the wall of the <ks>room</ks> and it's filled with a proper set of items when system starts.</td>
</tr>
<tr>
	<td class="title"><ks>dishwasher</ks></td>
	<td>It's a non-smart resource embedded into the wall of the <ks>room</ks> and it's empty when system starts.</td>
</tr>
<tr>
	<td class="title"><ks>table</ks></td>
	<td>It's a non-smart resource put in the center of the <ks>room</ks>.</td>
</tr>
<tr>
	<td class="title"><ks>RBR - <i>Room Butler Robot</i></ks></td>
	<td>It's a <ks>DDR</ks> able to work as a Room Butler: it must be able to comunicate with <ks>maître's smartphone</ks> and <ks>fridge</ks> and to walk around the <ks>room</ks> to execute the <ks>task</ks>, avoiding the fixed and mobile obstacles. When system starts and when it's not executing any <ks>task</ks>, it must be in the <ks>RH</ks> position.</td>
</tr>
<tr>
	<td class="title"><ks>DDR - <i>Differential Drive Robot</i></ks></td>
	<td>The customer provided all the documentation about this topic: the documentation about the basicRobot (at <a href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2021/main/it.unibo.qak21.basicrobot/userDocs/basicrobot2021.html" target="_black">basicrobot2021.html</a>), that can be implemented as a virtual robot (at <a href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2021/main/it.unibo.virtualRobot2020/userDocs/VirtualRobot2021.html" target="_black">VirtualRobot2021.html</a>) or as a real robot, that can be an mbot (at <a href="https://htmlpreview.github.io/?https://github.com/anatali/issLab2021/blob/main/it.unibo.qak21.basicrobot/userDocs/Mbot2020.html" target="_black">MBot2020.html</a>) or a nano robot (at <a href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2021/main/it.unibo.qak21.basicrobot/userDocs/LabNanoRobot.html" target="_black">LabNanoRobot.html</a>).</td>
</tr>
<tr>
	<td class="title"><ks>RH - <i>Robot Home</i></ks></td>
	<td>It's the position in the <ks>room</ks> where the <ks>RBR</ks> boots up and where he comes back after every <ks>task</ks>.</td>
</tr>
<tr>
	<td class="title"><ks>task</ks></td>
	<td>It's a task that the <ks>RBR</ks> must execute when required by <ks>Maître de Salle</ks> via <ks>maître's smartphone</ks>. There are three possible tasks: <ks>Prepare the room</ks>, <ks>Add food</ks> and <ks>Cleare the room</ks>.</td>
</tr>
<tr>
	<td class="title"><ks>Prepare the room</ks></td>
	<td>This task consists in putting on the <ks>table</ks> dishes taken from the <ks>pantry</ks> and food taken from the <ks>fridge</ks>. The set of items to put on the table is fixed and it's properly described somewhere.</td>
</tr>
<tr>
	<td class="title"><ks>Add food</ks></td>
	<td>This task consists in putting on the <ks>table</ks> some specific food (defined by a <ks>food-code</ks>) taken from the <ks>fridge</ks> if it exists.</td>
</tr>
<tr>
	<td class="title"><ks>food-code</ks></td>
	<td>Univoque code associated to a specific food.</td>
</tr>
<tr>
	<td class="title"><ks>Clear the room</ks></td>
	<td>This task consists in putting in the <ks>dishwasher</ks> and in the <ks>fridge</ks> respectively dishes and non-consumed food taken from the <ks>table</ks>.</td>
</tr>
</table>

<h3>Requirements analysis</h3>

Once we have understood the main concepts set by the <a href=#req_text>requirements text</a> given by the customer, it's now possible to analyze them.
<br><br>
<table>
<tr>
	<td>The software system is a distribuited system composed by three main entities:
	<ul>
		<li><ks>RBR</ks>, running on its own <kc>robotNode</kc>;</li>
		<li><ks>maître's smartphone</ks>, running on a <kc>maitreNode</kc>;</li>
		<li><ks>fridge</ks>, running on a <kc>fridgeNode</kc>. </li>
	</ul>
	</td>
	<td class="image"><img src="./utils/img/threeEntities.png" alt="Three entities"></td>
</tr>
<tr>
	<td>The software running on <kc>maitreNode</kc> must allow <ks>Maître de Salle</ks> to:
	<ul>
		<li>send the commands to <ks>RBR</ks> to execute tasks or to stop and reactive them;</li>
		<li>known and to show the objects related to each resources (smart and non-smart), so he must be able to comunicate with <ks>fridge</ks> too.</li>
	</ul>
	</td>
	<td class="image" rowspan="3"><img src="./utils/img/entitiesRel.png" alt="Relationships between entities"></td>
</tr>
<tr>
	<td>The software running on <kc>robotNode</kc> must be able to:
	<ul>
		<li>execute the <ks>task</ks> associated to command received by the <ks>maître's smartphone</ks>;</li>
		<li>stop/reactive a running <ks>task</ks> when it's required by the <ks>maître's smartphone</ks>;</li>
		<li>ask to <ks>fridge</ks> if it contains a specific food defined by a <ks>food-code</ks> and to receive the answer;</li>
		<li>send a warning to the <ks>maître's smartphone</ks> when the <ks>fridge</ks> doesn't contain the food required;</li>
		<li>return to his <ks>RH</ks> at the end of every <ks>task</ks>;</li>
		<li>avoid the impact with obstacles.</li>
	</ul>
	</td>
</tr>
<tr>
	<td>The software running on <kc>fridgeNode</kc> must be able to:
		<ul>
		<li>answer to the <ks>maître's smartphone</ks>, via CoAP, with his content when it's required;</li>
		<li>answer to the <ks>RBR</ks>, via CoAP, when it asks if it contains a specific food defined by a <ks>food-code</ks>.</li>
		</ul>
	</td>
</tr>
</table>

<h3>A first set of functional Test Plans</h3>

<h4>Scenario</h4>

Here, it's illustrated a possible scenario of the system:
<br><br>
<ol>
	<li>The <ks>room</ks> is empty, beside the <ks>Maître de Salle</ks>. The <ks>RBR</ks> is on its <ks>RH</ks>. The <ks>fridge</ks> and the <ks>pantry</ks> are embedded with a proper set of items; while the <ks>dishwasher</ks> is empty.</li>
	<li>The <ks>Maître de Salle</ks> sends the command <em>prepare</em> (for the <ks>task</ks> <ks>Prepare the room</ks>) to the <ks>RBR</ks> and wait. The <ks>RBR</ks> executes the <ks>task</ks> related to the command and at the end he returns to its <ks>RH</ks>.</li>
	<li>The party starts and the <ks>room</ks> is opened to people: so now there are other obstacoles in the <ks>room</ks>. The <ks>Maître de Salle</ks> can sends at any time to <ks>RBR</ks> the command <em>addFood (food-code)</em> (for the <ks>task</ks> <ks>Add food</ks>). The <ks>RBR</ks> asks to <ks>fridge</ks> if it has the food specified by <ks>food-code</ks> and the <ks>fridge</ks> answers to <ks>RBR</ks>, via CoAP, with command <em>answer</em>. If the <ks>fridge</ks> doesn't contain that food, then the <ks>RBR</ks> sends a warning to the <ks>Maître de Salle</ks>; otherwise the <ks>RBR</ks> executes the <ks>task</ks> and then he returns to its <ks>RH</ks>.</li>
	<li>At the end of the party the <ks>room</ks> is empty again, beside the <ks>Maître de Salle</ks>. The <ks>Maître de Salle</ks> sends to <ks>RBR</ks> the command <em>clear</em> (for the <ks>task</ks> <ks>Clear the room</ks>) and wait. The <ks>RBR</ks> executes the <ks>task</ks> and then he returns to its <ks>RH</ks>.</li>
</ol>
At every time of the service:
	<ul>
		<li>the <ks>Maître de Salle</ks> can use command <em>consult</em> to know the state of each element in the <ks>room</ks>. In this case, the <ks>fridge</ks> answers via CoAP, using the command <em>expose</em>, to show its content.</li>
		<li>the <ks>Maître de Salle</ks> can use the command <em>stop</em> or <em>reactive</em> to stop or restart an activated <ks>task</ks>.</li>
		<li>The <ks>RBR</ks> must <em>avoid</em> the obstacles.</li>
	</ul>


<h4>Test Plans</h4>

It's necessary to make some test plans that must be verified for the correct working of the final system, according to the requirements provided by the customer. Below it's reported a first planning of tests.
<br><br>
<ol>
<li>At the start of the system, it's necessary to verify that the <ks>RBR</ks> is positioned on (the cell of???) its <ks>RH</ks>. (BISOGNA TESTARE LO STATO ANCHE DEGLI ALTRI ELEMENTI DELLA STRANZA??????)</li>
<li>Tests of: the communications between entities (maitre-RBR); the path (EFFETTUATO)/carried out by the <ks>RBR</ks> that must be the one expected to execute/perform the <ks>task</ks> required by the <ks>Maître de Salle</ks>; (same as in step '1').</li>
<li>Tests of: (same as in step '2') the communications between entities (// and viceversa, RBR-fridge and viceversa); // if possible (if the fridge contains the food required); (same as in step '1').</li>
<li>Tests of: (same as in step '2' and '1').</li>
<li>Tests of the content/state(?????? È NECESSARIO???) of each element in the room and of all the communications between entities.</li>
<li>Test on the functionality (????????) of the <ks>RBR</ks> to avoid all the possible obstacles.</li>
</ol>
<hr>
<ul>
<li>Test(S??) of the position of the <ks>RBR</ks> that must be on its <ks>RH</ks> when system starts and at the end of each <ks>task</ks>.</li>
<li>Test(S??) of all the communications between entities (maitre - RBR, maitre - fridge, RBR - fridge and each vice versa).</li>
<li>Test(S??) of the path (EFFETTUATO)/carried out by the <ks>RBR</ks> that must be the one expected to execute/perform the <ks>task</ks> required by the <ks>Maître de Salle</ks>.</li>
<li>(QUESTO PUò ANDAR BENE???)Test of the state of the robot to verify its reaction when it receives command stop or reactive (E PER SAPERE COSA STA FACENDO? MA QUESTO E CIÒ CHE FACCIAMO PER SAPERE SE IL PERCORSO EFFETTUATO DA RBR SIA QUELLO GIUSTO! QUINDI TEST NON NECESSARIO????????)</li>
<li>Test on the functionality (????????) of the <ks>RBR</ks> to avoid all the possible obstacles.</li>
Test sulla posizione del robot all'interno della stanza <br>
Test sugli stati delle entità ad ogni transizione del sistema.
</ul>


<h4>Scenario</h4>

Here, it's illustrated a possible scenario of the system.
<br><br>
<table>
<tr>
<th>Steps in the scenario</th>
<th>Simplified representation of each step</th>
</tr>
<tr>
	<td><ol><li>The <ks>room</ks> is empty, beside the <ks>Maître de Salle</ks>. The <ks>RBR</ks> is on its <ks>RH</ks>. The <ks>fridge</ks> and the <ks>pantry</ks> are embedded with a proper set of items; while the <ks>dishwasher</ks> is empty.</li></ol></td>
	<td class="imageScenario"><img src="./utils/img/InitialScenario.png" alt="Initial scenario"></td>
</tr>
<tr>
	<td><ol start="2"><li>The <ks>Maître de Salle</ks> sends the command <em>prepare</em> (for the <ks>task</ks> <ks>Prepare the room</ks>) to the <ks>RBR</ks> and wait. The <ks>RBR</ks> executes the <ks>task</ks> related to the command and at the end he returns to its <ks>RH</ks>.</li></ol></td>
	<td class="imageScenario"><img src="./utils/img/ScenarioPrepare.png" alt="Scenario 'Prepare the room'"></td>
</tr>
<tr>
	<td><ol start="3"><li>The party starts and the <ks>room</ks> is opened to people: so now there are other obstacoles in the <ks>room</ks>. The <ks>Maître de Salle</ks> can sends at any time to <ks>RBR</ks> the command <em>addFood (food-code)</em> (for the <ks>task</ks> <ks>Add food</ks>). The <ks>RBR</ks> asks to <ks>fridge</ks> if it has the food specified by <ks>food-code</ks> and the <ks>fridge</ks> answers to <ks>RBR</ks>, via CoAP, with command <em>answer</em>. If the <ks>fridge</ks> doesn't contain that food, then the <ks>RBR</ks> sends a warning to the <ks>Maître de Salle</ks>; otherwise the <ks>RBR</ks> executes the <ks>task</ks> and then he returns to its <ks>RH</ks>.</li></ol></td>
	<td class="imageScenario"><img src="./utils/img/ScenarioAddFood.png" alt="Scenario 'Add food'"></td>
</tr>
<tr>
	<td><ol start="4"><li>At the end of the party the <ks>room</ks> is empty again, beside the <ks>Maître de Salle</ks>. The <ks>Maître de Salle</ks> sends to <ks>RBR</ks> the command <em>clear</em> (for the <ks>task</ks> <ks>Clear the room</ks>) and wait. The <ks>RBR</ks> executes the <ks>task</ks> and then he returns to its <ks>RH</ks>.</li></ol></td>
	<td class="imageScenario"><img src="./utils/img/ScenarioClear.png" alt="Scenario 'Clear the room'"></td>
</tr>
<tr>
	<td>At every time of the service:
	<ul>
		<li>the <ks>Maître de Salle</ks> can use command <em>consult</em> to know the state of each element in the <ks>room</ks>. In this case, the <ks>fridge</ks> answers via CoAP, using the command <em>expose</em>, to show its content.</li>
		<li>the <ks>Maître de Salle</ks> can use the command <em>stop</em> or <em>reactive</em> to stop or restart an activated <ks>task</ks>.</li>
		<li>The <ks>RBR</ks> must <em>avoid</em> the obstacles.</li>
	</ul>
	</td>
	<td class="imageScenario"><img src="./utils/img/ScenarioConsult.png" alt="Scenario Consult"></td>
</tr>
</table>

<h3>A first model of the system architecture</h3>

In particular, from this analysis and from the command names provided by the requirements text, we can realize a first model of the system architecture that is an initial representation of this system.
<br><br>
<table>
<tr>
<th>Interaction between entities, written in natural language, using words provided by the requirements text</th>
<th>First representation/model of the system</th>
</tr>
<tr>
<td>Comportamento:
	- torna a posizione iniziale
	- é in grado di eseguire i task senza collisioni 
	- si ferma e riparte se riceve i comandi da parte del maître</td>
<td class="image" rowspan="4"><img src="./utils/img/modelFromReqAnalysis.png" alt="Representation of the system from Requirements Analysis"></td>
</tr>
<tr>
<td><pre>Comunication Maitre - RBR robotCmd : robotCmd(X) X=[**addFood(foodCode)**, clear, prepare, stop, restart]{
	command Task (prepare addfood(food-code) clear) 
	command handle (stop/restart)
	task ("Prepare the room" "Add food" "Clear the room")
}

Comunication Maitre - Fridge/Maitre : **consultCmd** {  
	command consult (ROOM)
	(Maitre knowns the state of non-smart elements, and asks to the smart devices to know their state)	
}
</pre></td>
</tr>
<tr>
<td><pre>Comunication RBR - Maitre fail:fail(m) {
	report of failure after receiving answer(no) from Fridge (if there isn't food=food-code in the fridge)
}

Comunication RBR - Fridge ask:ask(foodCode) {
	command ask(food-code) after receiving command addfood(food-code) from Maitre
}
</pre></td>
</tr>
<tr>
<td><pre>Comunication Fridge -  Maitre expose : expose(state) {
	command expose after receiving command consult from Maitre
}

Comunication Fridge - RBR answer:answer(Y) Y(Y=[yes,no]) {
	command answer after receiving command ask(food-code) from RBR
}
</pre></td>
</tr>
</table>

<h2>Problem analysis</h2>

<h3>Requirements traceability</h3>

[achievied from the requirement analysis]
Using a meta-model written in a machine-understandble language, like QActor, we can obtain aN UNIVOQUE representation of the system architecture that describes the associations between requirements and the running elements (represented by the actors).

<a href="./Analisi.qak" target="_black">representation of a system architecture</a><br>
<iframe src="./Analisi.qak" title="sysArchRepr">
<a href="./Analisi.qak" target="_black">representation of a system architecture</a>
</iframe>

<h3>Problem analysis</h3>

The main goal of problem analysis can be summarized as follows:
<ol>
<li>understand the (technical) problems posed by the requirements;</li>
<li>identify the best tools/libraries/supports etc. necessary and/or useful for building the system;</li>
<li>clarify the constraints (human, technical, economical, etc.) related to both the software product to build and the software production process;</li>
<li>define a logical architecture of the system and a first working prototype to show to the customer at the end of our first sprint.</li>
</ol>
In the context of SCRUM, one or more of these steps will be redone in the sprint-review meetings. 

<hr>
In our scenario:
<ol>
<li><dl>
	<dt>**General System**</dt>
	<dd>The system is distribuited. To model it, it's available the **QAk-infrastracture** meta-model, developed and provided by our company. This meta-model provides a built-in message-driven tecnology. In a first moment using the QAk we work just locally. To support the distribuited features, the **MQTT** and **web** tecnologies are introduced and it's required the **CoAP** support to the fridge comunications.</dd>
</dl></li>
<li><dl>
	<dt>**Robot** (controlla librerie)</dt>
	<dd>Il robot per eseguire i task deve essere in grado di raggiungere tutti gli obiettivi (frigo, tavolo, lavastoviglie, dispensa) con cui interagire. Essendo questi elementi fissi nella stanza una soluzione può essere il **mappaggio della stanza** all'avvio del robot.</dd>
	<dd>Il mappaggio può essere implementato tramite le librerie ... fornite della software house.</dd>
	<dd>Robot come componente proattivo/reattivo (riceve ed esegue i comandi, reagisce agli eventi (prodotti dall'attore sonar) per soddisfare il requisito 'avoid the impact with the mobile obstacles')</dd>
	<dd>Per soddisfare il requisito 'avoid the impact with the mobile obstacles' possiamo pensare di utilizzare (eventi per gestire) i dati raccolti da un sensore, che può essere reppresentato da un sonar (sia nel robot fisico che in quello virtuale). </dd>
	<dd>La gestione del sonar è fornita delle librerie .... della software house.</dd>
	<dd>Nel prossimo sprint valuteremo l idea di rendere il sonar un attore indipendente dal robot.</dd>
	<dd>The robot component represents the control part of the system. To make such a control independent form the particular type of robot to move (virtual, real-mbot, real-nano, etc.) it is opportune to introduce a resource robotSupport.kt working as a robot-facade. </dd>
</dl></li>
<li><dl>
	<dt>**Maitre**</dt>
	<dt>**valutare utilizzo di console**</dt>
	<dt>**interfaccia sviluppabile sia web-oriented che come app android**</dt>
	<dd>Possibilità di gestire lo stato degli oggetti non smart per mezzo di attori dedicati a ciascun oggetto all'interno del contesto del maitre.</dd>
	<dd>Possibilità di inserire un support per configurare dispositivi ora non smart che in futuro possono essere smart.</dd>
	<dd>Potremmo prevedere un attore XY in grado di ricevere i warning dal robot in qualsiasi momento.</dd>
	<dd>Possibilità di configurare la stanza e gli oggetti non smart all'avvio del sistema.</dd>
</dl></li>
<li><dl>
	<dt>**Fridge**</dt>
	<dd>Possibilità di **utilizzare android per IoT** / oppure **interfaccia web**</dd>
	<dd>Possibilità di popolarlo all'avvio del sistema.</dd>
</dl></li>
</ol>

<h2>Test plans</h2> 


<h2>Project</h2> 



<h2>Testing</h2> 
 

<h2>Deployment</h2> 

 
<h2>Maintenance</h2> 

</div>
<br><br>
<div class="endpage">
By Romeo Stefano (stefano.romeo@studio.unibo.it) and Russo Maria (maria.russo10@studio.unibo.it)<br>
<img class="photo" src="./utils/img/StefanoRomeo.png" alt="Stefano Romeo image">
<img class="photo" src="./utils/img/MariaRusso.png" alt="Maria Russo image">

</div>

<div>elementi utili:</div>
Table:
<table>
<tr>
	<td></td>
	<td></td>
</tr>
</table>
Sorted List:
<ol>
<li></li>
<li></li>
</ol>
Unordered List:
<ul>
<li></li>
<li></li>
</ul>
Definition list:
<dl>
<dt></dt>
<dd></dd>
</dl>
Link:
<a href="" target="_black"></a>
Image:
<img src="./utils/img/Nome.png" alt="description">
Key words:
<ks></ks>
commands:
<em></em>
</body>
</html>	<td></td>
